<div align="center" style="align-items: center; display: flex; justify-content: center; gap: 10px;">
    <img src="Imgs/UP70_LOGO_Ramp_Simp.png" alt="Up70" width="240">
    <img src="Imgs/Up70Art_Ramp.png" alt="Up70Char" width="240" height="120" >
</div>

<div align="center">
<h1>南京理工大学Up70战队大疆A板电控框架</h1>
</div>

## 简介
基于 ***DJI A Board*** 搭建的电控框架库，包含 `Bsp`、`Module`、`App`、`Sys`层。其中，`App`和`Sys`处于同一级。

用户基本无需更改App层以下的任何代码，即可搭建自己的逻辑框架 
同时，用户在使用时，也 ***严禁更改非用户代码区的任何代码***

***本架构仍在持续更新中！！！请积极 <u>提 ISSUE</u> 和 <u>拉取最新代码</u>***

## 设计原则
1. 应该保持 ***Bsp*** -> ***Module(Mod)*** -> ***System(Sys) = Application(App)*** 三层架构
2. 应明确用户 可以自定义的代码范围 和 不可以更改的代码范围
3. 固有代码应保持稳定，同时积极修复bug和添加新功能
4. 代码风格保持一致，同时高度封装和模块化

## 层级
### Bsp层 （Libs文件夹）
当前内含有：
```cpp
    bsp_can
    bsp_dwt
    bsp_uart
    std_cpp             // （C与Cpp的接口文件）
    std_math            // （自定义的常用数学库，比如向量运算）
    pids                // （自定义的PID控制器）
```

### Mod层
pass

### Sys层
本层级主要包含通用的机器人系统级的功能
> 本层级存在的意义是：  
> 规范机器人系统的整体应用框架，并为机器人提供一些通用的功能和保障

#### 机器人系统
1. ***注册***  
所有的模块在初始化时，都应该在机器人系统中 **完成注册**  
考虑到各层级 **单向调用** 的原则，代码编写时，不应在模块初始化Init中自动注册  
而是应该在机器人系统的初始化时，手动向其中上报已实例化的模块
2. ***监控***  
机器人系统会实时监控所有 `已注册的模块` 的在线状态，如果可以，会将其持续上报给上位机进行存档。  
注册时，可以给模块设定 **紧急度** ，以便在模块掉线时，机器人系统可以根据紧急度进行相应的处理。

3. ***调度***  
机器人系统中内含了 `状态机核心`。在系统初始化时，状态机就会初始化。  
因此，系统也会实时监控状态机的运行情况，并一并发送给上位机存档。

4. ***通用初始化***  
机器人系统中还包含了一些通用的，一定会用到的初始化函数。比如`DWT计时器`等。

### App层
本层级大部分为用户自定义代码区
> 本层级存在的意义是：  
> 完成机器人的总体抽象化的、任务级的逻辑框架，以及一些通用的信息处理、动作执行机制  
> 本层的代码应该是高度抽象的，与硬件无关的，即使硬件库未完工，也不影响代码编写（只影响部署验证）


比较基础的文件有：
```cpp
    Chassis.cpp         // 车体的底盘逻辑
    Test.cpp            // 用于临时测试的代码
    Process.cpp         // 用户自定义的逻辑代码
    MsgCenter.cpp       // 消息中心，统一在此处管理信息流
```